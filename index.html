<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aesthetic Expense Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* Dark Gray */
            color: #F3F4F6; /* Light Gray */
        }
        .card {
            background-color: #1F2937; /* Darker card background */
            border: 1px solid #374151;
        }
        .progress-bar-bg {
            background-color: #374151;
        }
        .progress-bar-fill {
            background: linear-gradient(to right, #10B981, #34D399);
        }
        .btn-primary {
            background-color: #10B981; /* Emerald-500 */
            color: white;
            transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background-color: #059669; /* Emerald-600 */
        }
        .input-field {
            background-color: #374151; /* Gray-700 */
            border: 1px solid #4B5563; /* Gray-600 */
            color: #F3F4F6;
        }
        .input-field:focus {
            outline: none;
            border-color: #10B981;
            box-shadow: 0 0 0 2px #10B981;
        }
        ::-webkit-calendar-picker-indicator {
            filter: invert(1);
        }
        .expense-list-container {
            max-height: 176px; /* 11rem, approx 4 items visible */
            overflow-y: auto;
            padding-right: 8px; /* Space for scrollbar */
        }
        /* Custom scrollbar styling */
        .expense-list-container::-webkit-scrollbar {
            width: 6px;
        }
        .expense-list-container::-webkit-scrollbar-track {
            background: transparent;
        }
        .expense-list-container::-webkit-scrollbar-thumb {
            background: #4B5563; /* Gray-600 */
            border-radius: 3px;
        }
        .expense-list-container::-webkit-scrollbar-thumb:hover {
            background: #6B7280; /* Gray-500 */
        }
    </style>
</head>
<body class="antialiased">
    <canvas id="background-canvas" class="fixed top-0 left-0 w-full h-full -z-10"></canvas>
    <div class="container mx-auto p-4 md:p-8 max-w-4xl relative z-10">
        
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white tracking-tight">Annual Expense Tracker</h1>
            <p class="text-gray-400 mt-2">Track your rent, utilities, and food spending with ease.</p>
        </header>
        
        <main id="app-content">
            <!-- Overall Summary Card -->
            <div class="card p-6 rounded-xl shadow-lg mb-8">
                <h2 class="text-xl font-semibold mb-4 text-white">Overall Summary</h2>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-center mb-4">
                    <div>
                        <p class="text-sm text-gray-400">Total Budget</p>
                        <p id="total-budget-display" class="text-3xl font-bold text-white">$0.00</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400">Total Spent</p>
                        <p id="total-spent-display" class="text-3xl font-bold text-emerald-400">$0.00</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400">Total Remaining</p>
                        <p id="total-remaining-display" class="text-3xl font-bold text-white">$0.00</p>
                    </div>
                </div>
                <div class="w-full progress-bar-bg rounded-full h-3">
                    <div id="total-progress-bar" class="progress-bar-fill h-3 rounded-full" style="width: 0%"></div>
                </div>
            </div>

            <!-- Settings & Add Expense Forms -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <!-- Budget Settings Card -->
                <div class="card p-6 rounded-xl shadow-lg">
                    <h2 class="text-xl font-semibold mb-4 text-white">Update Total Budget</h2>
                    <form id="budget-form">
                        <label for="total-budget-input" class="block text-sm font-medium text-gray-300 mb-2">Set new total amount</label>
                        <div class="flex items-center space-x-2">
                            <span class="text-gray-400 text-lg">$</span>
                            <input type="number" id="total-budget-input" name="total-budget-input" class="input-field w-full px-4 py-2 rounded-md focus:ring-2 focus:ring-emerald-500" placeholder="e.g., 11000" step="100" min="0">
                            <button type="submit" class="btn-primary font-semibold px-4 py-2 rounded-md shadow-sm">Set</button>
                        </div>
                    </form>
                </div>
                
                <!-- Add Expense Card -->
                <div class="card p-6 rounded-xl shadow-lg">
                    <h2 class="text-xl font-semibold mb-4 text-white">Add New Expense</h2>
                    <form id="expense-form" class="space-y-4">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label for="expense-date" class="block text-sm font-medium text-gray-300">Date</label>
                                <input type="date" id="expense-date" name="expense-date" class="input-field mt-1 block w-full px-3 py-2 rounded-md" required>
                            </div>
                            <div>
                                <label for="expense-category" class="block text-sm font-medium text-gray-300">Category</label>
                                <select id="expense-category" name="expense-category" class="input-field mt-1 block w-full px-3 py-2 rounded-md" required>
                                    <option value="Food">Food</option>
                                    <option value="Rent">Rent</option>
                                    <option value="Utilities">Utilities</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label for="expense-description" class="block text-sm font-medium text-gray-300">Description</label>
                            <input type="text" id="expense-description" name="expense-description" class="input-field mt-1 block w-full px-3 py-2 rounded-md" placeholder="e.g., Groceries, Electric Bill" required>
                        </div>
                        <div>
                            <label for="expense-amount" class="block text-sm font-medium text-gray-300">Amount</label>
                            <div class="relative mt-1">
                                <div class="pointer-events-none absolute inset-y-0 left-0 pl-3 flex items-center">
                                    <span class="text-gray-400 sm:text-sm">$</span>
                                </div>
                                <input type="number" id="expense-amount" name="expense-amount" class="input-field block w-full pl-7 pr-3 py-2 rounded-md" placeholder="0.00" step="0.01" min="0" required>
                            </div>
                        </div>
                        <button type="submit" class="w-full btn-primary font-bold py-2.5 rounded-md shadow-lg">Add Expense</button>
                    </form>
                </div>
            </div>

            <!-- Expenses Display -->
            <div id="expenses-container" class="space-y-8">
                <!-- Monthly expense cards will be injected here by JavaScript -->
            </div>
             <div id="no-expenses-message" class="text-center card p-8 rounded-xl shadow-lg mt-8 hidden">
                <h3 class="text-lg font-semibold text-white">No expenses yet!</h3>
                <p class="text-gray-400">Your rent has been pre-filled. Add food and utility expenses to get started.</p>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Background Animation ---
            const canvas = document.getElementById('background-canvas');
            const ctx = canvas.getContext('2d');
            let width, height;
            let step = 0;
            let boatX = -150; 
            const fishes = [];
            const jellyfishes = [];

            function setupCanvas() {
                width = canvas.width = window.innerWidth;
                height = canvas.height = window.innerHeight;
                if (fishes.length === 0) createFishes();
                if (jellyfishes.length === 0) createJellyfish();
            }
            
            function createJellyfish() {
                for (let i = 0; i < 5; i++) {
                    jellyfishes.push({
                        x: Math.random() * width,
                        y: Math.random() * (height - 150) + 150, // Spawn below the waves
                        radius: Math.random() * 10 + 5,
                        speed: Math.random() * 0.3 + 0.1,
                        angle: Math.random() * Math.PI * 2,
                        tentacles: Array.from({ length: 5 }, () => ({
                            length: Math.random() * 40 + 20,
                            swing: Math.random() * 0.02 + 0.01,
                            offset: Math.random() * Math.PI * 2
                        }))
                    });
                }
            }

            function drawJellyfish(jelly) {
                ctx.strokeStyle = 'rgba(200, 220, 255, 0.2)';
                ctx.fillStyle = 'rgba(200, 220, 255, 0.1)';
                ctx.lineWidth = 1.5;

                // Draw bell
                ctx.beginPath();
                const bellY = jelly.y + Math.sin(step + jelly.angle) * 3; // Pulsing motion
                ctx.arc(jelly.x, bellY, jelly.radius, Math.PI, 0);
                ctx.closePath();
                ctx.fill();
                ctx.stroke();

                // Draw tentacles
                jelly.tentacles.forEach(t => {
                    ctx.beginPath();
                    ctx.moveTo(jelly.x, bellY + jelly.radius - 2);
                    let currentY = bellY + jelly.radius - 2;
                    for (let j = 0; j < 10; j++) {
                        let swingX = Math.sin(j * 0.5 + step * 2 + t.offset) * (j / 2);
                        currentY += t.length / 10;
                        ctx.lineTo(jelly.x + swingX, currentY);
                    }
                    ctx.stroke();
                });
            }

            function updateJellyfish() {
                 jellyfishes.forEach(jelly => {
                    jelly.y += jelly.speed;
                    jelly.x += Math.sin(jelly.y * 0.01 + jelly.angle) * 0.3; // Gentle side to side
                    if (jelly.y > height + 50) {
                        jelly.y = 150; // Reset just below the waves
                        jelly.x = Math.random() * width;
                    }
                    drawJellyfish(jelly);
                });
            }

            function createFishes() {
                for(let i = 0; i < 8; i++) {
                    fishes.push({
                        x: Math.random() * width,
                        y: Math.random() * height * 0.6 + height * 0.4, // Lower part of the screen
                        size: Math.random() * 2 + 1,
                        speed: Math.random() * 0.5 + 0.2,
                        direction: Math.random() > 0.5 ? 1 : -1
                    });
                }
            }

            function drawFish(fish) {
                ctx.fillStyle = 'rgba(200, 220, 255, 0.15)'; // Faint glowing white
                
                const dir = fish.direction;
                const size = fish.size;
                const x = fish.x;
                const y = fish.y;

                // --- Draw Body (Pointy Oval) ---
                ctx.beginPath();
                const noseX = x + 8 * size * dir;
                const bodyRearX = x - 8 * size * dir;
                ctx.moveTo(noseX, y); // Start at the nose
                // Top curve
                ctx.quadraticCurveTo(x, y - 8 * size, bodyRearX, y);
                // Bottom curve
                ctx.quadraticCurveTo(x, y + 8 * size, noseX, y);
                ctx.closePath();
                ctx.fill();

                // --- Draw Tail Fin ---
                ctx.beginPath();
                ctx.moveTo(bodyRearX, y); // Start where body ends
                ctx.lineTo(bodyRearX - 6 * size * dir, y - 7 * size);
                ctx.lineTo(bodyRearX - 6 * size * dir, y + 7 * size);
                ctx.closePath();
                ctx.fill();

                // --- Draw Dorsal Fin (Top Fin) ---
                ctx.beginPath();
                ctx.moveTo(x + 2 * size * dir, y - 3 * size); // Point on the top of the body
                ctx.lineTo(x, y - 10 * size); // Peak of the fin
                ctx.lineTo(x - 3 * size * dir, y - 2 * size); // Back of the fin
                ctx.closePath();
                ctx.fill();
            }

            function updateFishes() {
                fishes.forEach(fish => {
                    fish.x += fish.speed * fish.direction;
                    if (fish.direction === 1 && fish.x > width + 20) {
                        fish.x = -20;
                    } else if (fish.direction === -1 && fish.x < -20) {
                        fish.x = width + 20;
                    }
                    drawFish(fish);
                });
            }

            function drawSailboat(waveTop) {
                boatX += 0.2; // Speed of the boat
                if (boatX > width + 150) {
                    boatX = -150;
                }
                
                const boatY = waveTop - 15; // Position boat on the wave

                // Hull (White)
                ctx.fillStyle = '#FFFFFF';
                ctx.beginPath();
                ctx.moveTo(boatX - 40, boatY);
                ctx.quadraticCurveTo(boatX, boatY + 15, boatX + 40, boatY);
                ctx.lineTo(boatX + 35, boatY - 10);
                ctx.lineTo(boatX - 35, boatY - 10);
                ctx.closePath();
                ctx.fill();

                // Mast (Dark Grey)
                ctx.strokeStyle = '#2d2d2d';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(boatX, boatY - 10);
                ctx.lineTo(boatX, boatY - 50);
                ctx.stroke();

                // Sail (Red)
                ctx.fillStyle = '#DC2626'; // A nice shade of red
                ctx.beginPath();
                ctx.moveTo(boatX + 2, boatY - 48);
                ctx.lineTo(boatX + 2, boatY - 15);
                ctx.lineTo(boatX + 25, boatY - 20);
                ctx.closePath();
                ctx.fill();
            }

            function drawAnimation() {
                if (!ctx) return;
                ctx.clearRect(0, 0, width, height);
                step += 0.015;

                updateFishes();
                updateJellyfish();

                const waveColors = ['rgba(29, 78, 216, 0.2)', 'rgba(13, 148, 136, 0.2)', 'rgba(30, 64, 175, 0.2)'];
                const waveParams = [
                    [0.003, 30, 60, 0, 1],
                    [0.004, 35, 75, 1, -1],
                    [0.002, 40, 90, 2, 0.8]
                ];
                
                let topWaveY = height;
                
                waveParams.forEach(([freq, amp, yOffset, colorIndex, speedMod]) => {
                    ctx.beginPath();
                    ctx.moveTo(0, 0); 
                    for (let x = 0; x < width; x++) {
                        const y = Math.sin(x * freq + step * speedMod) * amp + yOffset;
                        ctx.lineTo(x, y);
                        // Find the y position for the sailboat at its current x
                        if (x === Math.round(boatX) && colorIndex === 1) { 
                           topWaveY = y;
                        }
                    }
                    ctx.lineTo(width, 0); 
                    ctx.closePath();
                    ctx.fillStyle = waveColors[colorIndex];
                    ctx.fill();
                });
                
                drawSailboat(topWaveY);

                requestAnimationFrame(drawAnimation);
            }

            window.addEventListener('resize', setupCanvas);
            setupCanvas();
            drawAnimation();
            
            // --- Local Storage Keys ---
            const BUDGET_KEY = 'expenseTracker_budget';
            const EXPENSES_KEY = 'expenseTracker_expenses';

            // --- App State ---
            let totalBudget = 0;
            let expenses = [];

            // --- UI Elements ---
            const budgetForm = document.getElementById('budget-form');
            const expenseForm = document.getElementById('expense-form');
            const totalBudgetDisplay = document.getElementById('total-budget-display');
            const totalSpentDisplay = document.getElementById('total-spent-display');
            const totalRemainingDisplay = document.getElementById('total-remaining-display');
            const totalProgressBar = document.getElementById('total-progress-bar');
            const expensesContainer = document.getElementById('expenses-container');
            const noExpensesMessage = document.getElementById('no-expenses-message');

            // --- Functions ---
            function saveData() {
                localStorage.setItem(BUDGET_KEY, totalBudget);
                localStorage.setItem(EXPENSES_KEY, JSON.stringify(expenses));
            }

            function loadData() {
                const savedBudget = parseFloat(localStorage.getItem(BUDGET_KEY));
                const savedExpenses = JSON.parse(localStorage.getItem(EXPENSES_KEY));

                totalBudget = savedBudget || 11000;

                // If there are no saved expenses at all, it's the first run.
                // In that case, pre-fill the rent expenses.
                if (!savedExpenses || savedExpenses.length === 0) {
                    expenses = []; // Start with a clean slate
                    prefillRent();
                } else {
                    expenses = savedExpenses; // Otherwise, load the existing expenses.
                }
            }

            function prefillRent() {
                const rentAmount = 650;
                const startDate = new Date('2025-06-01T00:00:00');
                
                for (let i = 0; i < 12; i++) {
                    const rentDate = new Date(startDate);
                    rentDate.setMonth(startDate.getMonth() + i);
                    
                    const newExpense = {
                        id: Date.now() + i,
                        date: rentDate.toISOString().split('T')[0], // YYYY-MM-DD
                        category: 'Rent',
                        description: `Rent for ${rentDate.toLocaleString('default', { month: 'long' })}`,
                        amount: rentAmount
                    };
                    expenses.push(newExpense);
                }
                saveData();
            }

            function renderApp() {
                renderSummary();
                renderExpenses();
            }

            function renderSummary() {
                const totalSpent = expenses.reduce((sum, exp) => sum + exp.amount, 0);
                const totalRemaining = totalBudget - totalSpent;
                const progress = totalBudget > 0 ? (totalSpent / totalBudget) * 100 : 0;

                totalBudgetDisplay.textContent = `$${totalBudget.toFixed(2)}`;
                totalSpentDisplay.textContent = `$${totalSpent.toFixed(2)}`;
                totalRemainingDisplay.textContent = `$${totalRemaining.toFixed(2)}`;
                totalProgressBar.style.width = `${Math.min(100, progress)}%`;
                
                if (totalRemaining < 0) {
                    totalRemainingDisplay.classList.remove('text-white');
                    totalRemainingDisplay.classList.add('text-red-400');
                } else {
                    totalRemainingDisplay.classList.add('text-white');
                    totalRemainingDisplay.classList.remove('text-red-400');
                }
            }

            function renderExpenses() {
                expensesContainer.innerHTML = '';
                if (expenses.length === 0) {
                    noExpensesMessage.classList.remove('hidden');
                    return;
                }
                noExpensesMessage.classList.add('hidden');
                
                const expensesByMonth = groupExpensesByMonth(expenses);
                const sortedMonths = Object.keys(expensesByMonth).sort((a,b) => new Date(a) - new Date(b));
                
                for (const monthKey of sortedMonths) {
                    const monthExpenses = expensesByMonth[monthKey];
                    const monthCard = createMonthCard(monthKey, monthExpenses);
                    expensesContainer.appendChild(monthCard);
                }
            }

            function groupExpensesByMonth(expenses) {
                return expenses.reduce((acc, expense) => {
                    const month = new Date(expense.date + 'T00:00:00').toLocaleString('default', { month: 'long', year: 'numeric' });
                    if (!acc[month]) {
                        acc[month] = [];
                    }
                    acc[month].push(expense);
                    return acc;
                }, {});
            }

            function createMonthCard(monthKey, monthExpenses) {
                const card = document.createElement('div');
                card.className = 'card p-6 rounded-xl shadow-lg';
                
                const rentSpent = monthExpenses.filter(e => e.category === 'Rent').reduce((sum, exp) => sum + exp.amount, 0);
                const utilitiesSpent = monthExpenses.filter(e => e.category === 'Utilities').reduce((sum, exp) => sum + exp.amount, 0);
                const foodSpent = monthExpenses.filter(e => e.category === 'Food').reduce((sum, exp) => sum + exp.amount, 0);
                
                const monthlyAverage = totalBudget / 12;
                const monthlyRemaining = monthlyAverage - rentSpent - utilitiesSpent - foodSpent;
                const remainingColorClass = monthlyRemaining < 0 ? 'text-red-400' : 'text-white';

                card.innerHTML = `
                    <h3 class="text-2xl font-bold text-white mb-4">${monthKey}</h3>
                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 mb-4 text-center">
                        <div>
                            <p class="text-sm text-gray-400">Rent Paid</p>
                            <p class="text-2xl font-semibold text-blue-400">$${rentSpent.toFixed(2)}</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-400">Utilities Paid</p>
                            <p class="text-2xl font-semibold text-yellow-400">$${utilitiesSpent.toFixed(2)}</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-400">Food Spending</p>
                            <p class="text-2xl font-semibold text-green-400">$${foodSpent.toFixed(2)}</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-400">Monthly Allowance Left</p>
                            <p class="text-2xl font-semibold ${remainingColorClass}">$${monthlyRemaining.toFixed(2)}</p>
                        </div>
                    </div>
                    <div class="border-t border-gray-700 mt-4 pt-4">
                        <div class="space-y-2 expense-list-container">${monthExpenses.sort((a, b) => new Date(a.date) - new Date(b.date)).map(exp => createExpenseRow(exp)).join('')}</div>
                    </div>
                `;
                return card;
            }

            function createExpenseRow(expense) {
                let categoryBg = '';
                switch(expense.category) {
                    case 'Rent': categoryBg = 'bg-blue-500/20 text-blue-300'; break;
                    case 'Utilities': categoryBg = 'bg-yellow-500/20 text-yellow-300'; break;
                    case 'Food': categoryBg = 'bg-green-500/20 text-green-300'; break;
                }
                const date = new Date(expense.date + 'T00:00:00');
                const formattedDate = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });

                return `
                    <div class="flex items-center justify-between p-2 rounded-lg hover:bg-gray-700/50 transition-colors duration-200">
                        <div class="flex items-center gap-4">
                            <span class="text-sm font-medium text-gray-400 w-12 text-center">${formattedDate}</span>
                            <div>
                                <p class="font-medium text-white">${expense.description}</p>
                                <p class="text-xs ${categoryBg} inline-block px-2 py-0.5 rounded-full">${expense.category}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="font-semibold text-white">$${expense.amount.toFixed(2)}</p>
                            <button data-id="${expense.id}" class="delete-btn text-xs text-red-400 hover:text-red-300 transition-colors">Delete</button>
                        </div>
                    </div>
                `;
            }

            // --- Event Handlers ---
            budgetForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const newBudget = parseFloat(document.getElementById('total-budget-input').value);
                if (!isNaN(newBudget) && newBudget >= 0) {
                    totalBudget = newBudget;
                    saveData();
                    renderApp();
                    budgetForm.reset();
                }
            });

            expenseForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const newExpense = {
                    id: Date.now(),
                    date: e.target['expense-date'].value,
                    category: e.target['expense-category'].value,
                    description: e.target['expense-description'].value,
                    amount: parseFloat(e.target['expense-amount'].value)
                };
                expenses.push(newExpense);
                saveData();
                renderApp();
                expenseForm.reset();
            });

            expensesContainer.addEventListener('click', (e) => {
                const deleteButton = e.target.closest('.delete-btn');
                if (deleteButton) {
                    const expenseId = parseInt(deleteButton.dataset.id, 10);
                    expenses = expenses.filter(exp => exp.id !== expenseId);
                    saveData();
                    renderApp();
                }
            });
            
            // --- Initial Load ---
            loadData();
            renderApp();
        });
    </script>
</body>
</html>










